# 토스페이먼츠 SDK 테스트 체크리스트

**작성일**: 2025-11-21  
**버전**: 1.0.0  
**상태**: 테스트 진행 중

---

## ⚠️ 알려진 이슈: SDK 로드 403 오류

**문제**: `https://js.tosspayments.com/v2` 스크립트 로드 시 403 Forbidden 오류 발생

**원인 분석**:
- `curl -I https://js.tosspayments.com/v2` 결과: `HTTP/2 403`
- 토스페이먼츠 서버가 직접 접근을 차단하는 것으로 보임
- 스크립트 태그를 통한 로드도 403 발생 시 네트워크/방화벽 문제 가능성

**해결 방법**:
1. 브라우저 개발자 도구 > 네트워크 탭에서 실제 HTTP 상태 코드 확인
2. 방화벽/프록시 설정 확인 (회사 네트워크, VPN 등)
3. 다른 네트워크 환경에서 테스트
4. 토스페이먼츠 고객센터 문의

**현재 상태**: 조사 중 (2025-11-21)

---

## ✅ 사전 준비 사항 확인

### 1. 환경 변수 설정 확인
- [x] 백엔드 환경 변수 확인 필요 (`.env.local` 또는 시스템 환경 변수)
- [x] Trinity (Next.js) `.env.local` 확인 필요
- [x] 웹앱 (React) `.env.local` 확인 필요

### 2. SDK 스크립트 로드 확인
- [x] `frontend-trinity/app/layout.tsx`에 토스페이먼츠 SDK 스크립트 태그 ✅
- [x] `frontend/public/index.html`에 토스페이먼츠 SDK 스크립트 태그 ✅

### 3. 공통 코드 등록 확인
- [ ] `SUBSCRIPTION_STATUS` 코드 그룹 등록 확인
- [ ] `BILLING_CYCLE` 코드 그룹 등록 확인
- [ ] `PG_PROVIDER` 코드 그룹 등록 확인

---

## 🧪 Phase 1: 기본 기능 테스트

### 1.1 Trinity 홈페이지 - 자동결제 등록 테스트

**테스트 일자**: [ ]  
**테스트 담당자**: [ ]  
**테스트 환경**: [ ]

#### 테스트 단계
1. [ ] Trinity 홈페이지 접속 (`http://localhost:3000`)
2. [ ] 온보딩 페이지 이동 (`/onboarding`)
3. [ ] 기본 정보 입력 (회사명, 업종, 연락처 등)
4. [ ] 요금제 선택
5. [ ] 결제 수단 등록 버튼 클릭
6. [ ] 토스페이먼츠 결제 창 표시 확인
7. [ ] 테스트 카드 정보 입력
   - **개인/법인**: 개인 선택
   - **카드번호**: **실제 카드번호 사용 가능** (테스트 환경에서는 실제 결제 발생하지 않음)
     - 또는 테스트 카드: `4111-1111-1111-1111` (VISA), `5555-5555-5555-4444` (MasterCard)
   - **유효기간**: 실제 카드 유효기간 또는 `12/25` (MM/YY 형식, 미래 날짜)
   - **주민등록번호 앞 7자리**: 실제 주민등록번호 또는 `9001011` (1990년 1월 1일, 남성)
   - **CVC**: 실제 CVC 또는 `123` (카드 뒷면 3자리)
   - **비밀번호**: 실제 카드 비밀번호 앞 2자리 또는 `123456`
   - ⚠️ **테스트 환경에서는 실제 결제가 발생하지 않습니다.**
8. [ ] 결제 완료 후 콜백 페이지 이동 확인
9. [ ] 성공 메시지 표시 확인
10. [ ] 백엔드 API 호출 확인 (빌링키 저장)

#### 결과
- [ ] 성공
- [ ] 실패

**발견된 이슈**:
1. [이슈 내용]
2. [이슈 내용]

**스크린샷/로그**:
- [ ] 콘솔 로그 캡처
- [ ] 네트워크 요청 캡처
- [ ] 에러 메시지 캡처

---

### 1.2 웹앱 - 자동결제 등록 테스트

**테스트 일자**: [ ]  
**테스트 담당자**: [ ]  
**테스트 환경**: [ ]

#### 테스트 단계
1. [ ] 웹앱 접속 (`http://localhost:3000`)
2. [ ] 결제 수단 등록 페이지 이동 (`/billing/payment-method`)
3. [ ] 결제 수단 등록 버튼 클릭
4. [ ] 토스페이먼츠 결제 창 표시 확인
5. [ ] 테스트 카드 정보 입력
   - **개인/법인**: 개인 선택
   - **카드번호**: **실제 카드번호 사용 가능** (테스트 환경에서는 실제 결제 발생하지 않음)
     - 또는 테스트 카드: `4111-1111-1111-1111` (VISA), `5555-5555-5555-4444` (MasterCard)
   - **유효기간**: 실제 카드 유효기간 또는 `12/25` (MM/YY 형식, 미래 날짜)
   - **주민등록번호 앞 7자리**: 실제 주민등록번호 또는 `9001011` (1990년 1월 1일, 남성)
   - **CVC**: 실제 CVC 또는 `123` (카드 뒷면 3자리)
   - **비밀번호**: 실제 카드 비밀번호 앞 2자리 또는 `123456`
   - ⚠️ **테스트 환경에서는 실제 결제가 발생하지 않습니다.**
6. [ ] 결제 완료 후 콜백 페이지 이동 확인
7. [ ] 성공 메시지 표시 확인
8. [ ] 백엔드 API 호출 확인

#### 결과
- [ ] 성공
- [ ] 실패

**발견된 이슈**:
1. [이슈 내용]
2. [이슈 내용]

---

### 1.3 구독 관리 테스트

**테스트 일자**: [ ]  
**테스트 담당자**: [ ]  
**테스트 환경**: [ ]

#### 테스트 단계
1. [ ] 구독 목록 조회 (`GET /api/v1/billing/subscriptions`)
2. [ ] 구독 생성 (`POST /api/v1/billing/subscriptions`)
3. [ ] 구독 상세 조회 (`GET /api/v1/billing/subscriptions/{id}`)
4. [ ] 구독 취소 (`DELETE /api/v1/billing/subscriptions/{id}`)
5. [ ] 구독 상태 변경 확인

#### 결과
- [ ] 성공
- [ ] 실패

**발견된 이슈**:
1. [이슈 내용]
2. [이슈 내용]

---

## 🧪 Phase 2: 통합 테스트

### 2.1 전체 플로우 테스트

**테스트 일자**: [ ]  
**테스트 담당자**: [ ]  
**테스트 환경**: [ ]

#### 테스트 단계
1. [ ] Trinity 홈페이지에서 온보딩 요청 생성
2. [ ] 결제 수단 등록
3. [ ] Ops 포털에서 온보딩 승인
4. [ ] 테넌트 생성 확인
5. [ ] 구독 자동 생성 확인
6. [ ] 첫 결제 진행 확인
7. [ ] 구독 활성화 확인

#### 결과
- [ ] 성공
- [ ] 실패

**발견된 이슈**:
1. [이슈 내용]
2. [이슈 내용]

---

### 2.2 에러 처리 테스트

**테스트 일자**: [ ]  
**테스트 담당자**: [ ]  
**테스트 환경**: [ ]

#### 테스트 케이스
- [ ] 결제 취소 시 처리
- [ ] 결제 실패 시 처리
- [ ] 네트워크 오류 시 처리
- [ ] 백엔드 API 오류 시 처리
- [ ] 타임아웃 처리

#### 결과
- [ ] 성공
- [ ] 실패

**발견된 이슈**:
1. [이슈 내용]
2. [이슈 내용]

---

## 📊 테스트 결과 요약

### 전체 통과율
- Phase 1: [ ]% (0/3)
- Phase 2: [ ]% (0/2)
- 전체: [ ]% (0/5)

### 발견된 이슈 목록
1. [이슈 제목]
   - 심각도: [ ] Critical / [ ] High / [ ] Medium / [ ] Low
   - 상태: [ ] 해결됨 / [ ] 진행 중 / [ ] 대기 중
   - 설명: [이슈 설명]

2. [이슈 제목]
   - 심각도: [ ] Critical / [ ] High / [ ] Medium / [ ] Low
   - 상태: [ ] 해결됨 / [ ] 진행 중 / [ ] 대기 중
   - 설명: [이슈 설명]

---

## 🎯 다음 단계

- [ ] 발견된 이슈 수정
- [ ] 재테스트
- [ ] 대시보드 테스트 진행
- [ ] 프로덕션 배포 준비

---

**마지막 업데이트**: 2025-11-21

