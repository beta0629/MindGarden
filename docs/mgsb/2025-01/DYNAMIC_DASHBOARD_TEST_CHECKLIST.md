# 동적 대시보드 시스템 통합 테스트 체크리스트

## 📋 개요

동적 대시보드 시스템의 통합 테스트를 위한 상세 체크리스트입니다. 시스템 재부팅 후 실제 환경에서 테스트를 진행합니다.

## 🎯 테스트 목표

1. 동적 대시보드 라우팅이 정상적으로 동작하는지 확인
2. 백엔드 API가 올바르게 대시보드 정보를 반환하는지 확인
3. 다양한 사용자 시나리오에서 대시보드가 올바르게 표시되는지 확인
4. 에러 케이스에서 폴백 동작이 정상인지 확인

## ✅ 테스트 시나리오

### 시나리오 1: 단일 테넌트 사용자 로그인

**전제 조건**:
- 테스트 사용자 계정 준비 (단일 테넌트에만 속한 사용자)
- 해당 테넌트에 역할별 대시보드가 설정되어 있어야 함

**테스트 단계**:

1. **일반 로그인 (ID/PW)**
   - [ ] 로그인 페이지 접근 (`/login`)
   - [ ] 유효한 계정으로 로그인 시도
   - [ ] 로그인 성공 확인

2. **AuthResponse 검증**
   - [ ] 브라우저 개발자 도구 → Network 탭 확인
   - [ ] `/api/auth/login` 응답 확인
   - [ ] `AuthResponse`에 `currentTenantRole` 필드 포함 확인
   - [ ] `currentTenantRole.tenantRoleId` 값 확인
   - [ ] `currentTenantRole.roleName` 값 확인

3. **동적 대시보드 조회 API 호출 확인**
   - [ ] Network 탭에서 `/api/v1/tenant/dashboards/current` 또는 `/api/v1/tenant/dashboards/by-role/{tenantRoleId}` 호출 확인
   - [ ] API 응답 상태 코드 200 확인
   - [ ] 응답 데이터에 대시보드 정보 포함 확인:
     - [ ] `dashboardId`
     - [ ] `dashboardName`
     - [ ] `dashboardType`
     - [ ] `isActive`
     - [ ] `isDefault`

4. **적절한 대시보드 컴포넌트 로드 확인**
   - [ ] 브라우저 콘솔에서 "✅ 동적 대시보드 라우팅" 로그 확인
   - [ ] 올바른 대시보드 경로로 리다이렉트 확인
   - [ ] 대시보드 컴포넌트가 정상적으로 렌더링되는지 확인
   - [ ] 대시보드 내용이 역할에 맞게 표시되는지 확인

**예상 결과**:
- 로그인 성공 후 동적 대시보드로 자동 리다이렉트
- 역할에 맞는 대시보드 컴포넌트 표시
- 콘솔에 성공 로그 출력

---

### 시나리오 2: 멀티 테넌트 사용자

**전제 조건**:
- 여러 테넌트에 접근 가능한 테스트 사용자 계정 준비
- 각 테넌트에 서로 다른 역할이 할당되어 있어야 함

**테스트 단계**:

1. **멀티 테넌트 사용자 로그인**
   - [ ] 로그인 페이지 접근
   - [ ] 멀티 테넌트 사용자로 로그인
   - [ ] 로그인 성공 확인

2. **테넌트 선택 화면 표시**
   - [ ] 테넌트 선택 모달/페이지 표시 확인
   - [ ] 접근 가능한 테넌트 목록 표시 확인
   - [ ] 각 테넌트의 역할 정보 표시 확인

3. **첫 번째 테넌트 선택**
   - [ ] 첫 번째 테넌트 선택
   - [ ] 해당 테넌트의 역할에 맞는 대시보드 표시 확인
   - [ ] Network 탭에서 올바른 `tenantRoleId`로 API 호출 확인

4. **테넌트 전환 테스트**
   - [ ] 테넌트 전환 기능 사용 (헤더 메뉴 등)
   - [ ] 다른 테넌트 선택
   - [ ] 새로운 테넌트의 역할에 맞는 대시보드 표시 확인
   - [ ] 세션의 `currentTenantRoleId` 업데이트 확인

**예상 결과**:
- 로그인 후 테넌트 선택 화면 표시
- 테넌트 선택 시 해당 테넌트의 역할에 맞는 대시보드 표시
- 테넌트 전환 시 대시보드가 올바르게 변경됨

---

### 시나리오 3: 소셜 로그인 (OAuth2)

**전제 조건**:
- 카카오/네이버/구글 OAuth2 설정 완료
- 소셜 로그인 계정 준비

**테스트 단계**:

1. **카카오 로그인**
   - [ ] 로그인 페이지에서 카카오 로그인 버튼 클릭
   - [ ] 카카오 인증 완료
   - [ ] OAuth2 콜백 처리 확인
   - [ ] 동적 대시보드 라우팅 확인

2. **네이버 로그인**
   - [ ] 네이버 로그인 버튼 클릭
   - [ ] 네이버 인증 완료
   - [ ] OAuth2 콜백 처리 확인
   - [ ] 동적 대시보드 라우팅 확인

3. **구글 로그인**
   - [ ] 구글 로그인 버튼 클릭
   - [ ] 구글 인증 완료
   - [ ] OAuth2 콜백 처리 확인
   - [ ] 동적 대시보드 라우팅 확인

**예상 결과**:
- 모든 소셜 로그인에서 동적 대시보드 라우팅 정상 동작
- OAuth2Callback.js에서 `redirectToDynamicDashboard` 호출 확인

---

### 시나리오 4: 온보딩 후 기본 대시보드 확인

**전제 조건**:
- 새로운 테넌트 온보딩 요청 생성
- 온보딩 승인 권한이 있는 관리자 계정

**테스트 단계**:

1. **새로운 테넌트 온보딩**
   - [ ] 온보딩 요청 생성
   - [ ] 관리자로 로그인하여 온보딩 승인
   - [ ] 온보딩 승인 완료 확인

2. **기본 대시보드 자동 생성 확인**
   - [ ] 데이터베이스에서 `tenant_dashboards` 테이블 확인
   - [ ] 해당 테넌트에 기본 대시보드 3개 생성 확인:
     - [ ] 학생/고객 대시보드
     - [ ] 선생님/상담사 대시보드
     - [ ] 관리자 대시보드
   - [ ] 각 대시보드의 `isDefault=true` 확인

3. **관리자 로그인 후 기본 대시보드 표시 확인**
   - [ ] 온보딩된 테넌트의 관리자 계정으로 로그인
   - [ ] 동적 대시보드 조회 API 호출 확인
   - [ ] 기본 관리자 대시보드 표시 확인

**예상 결과**:
- 온보딩 승인 시 기본 대시보드 3개 자동 생성
- 관리자 로그인 시 기본 관리자 대시보드 표시

---

## 🚨 에러 케이스 테스트

### 케이스 1: 대시보드가 없는 경우

**전제 조건**:
- 역할에 대시보드가 매핑되지 않은 테스트 사용자

**테스트 단계**:

1. **대시보드 없음 시나리오**
   - [ ] 해당 역할의 사용자로 로그인
   - [ ] 동적 대시보드 조회 API 호출 확인
   - [ ] API 응답이 `null` 또는 빈 데이터인지 확인

2. **레거시 폴백 동작 확인**
   - [ ] 콘솔에서 "⚠️ 레거시 대시보드 라우팅" 로그 확인
   - [ ] `getLegacyDashboardPath()` 함수 호출 확인
   - [ ] 역할에 맞는 레거시 경로로 리다이렉트 확인
   - [ ] 레거시 대시보드 컴포넌트 정상 표시 확인

**예상 결과**:
- 대시보드가 없을 때 레거시 경로로 폴백
- 사용자에게 오류 없이 대시보드 표시

---

### 케이스 2: 비활성화된 대시보드

**전제 조건**:
- 역할에 매핑된 대시보드가 있지만 `isActive=false`인 경우

**테스트 단계**:

1. **비활성화된 대시보드 조회**
   - [ ] 해당 역할의 사용자로 로그인
   - [ ] 동적 대시보드 조회 API 호출 확인
   - [ ] API가 비활성화된 대시보드를 제외하고 조회하는지 확인

2. **기본 대시보드로 폴백 확인**
   - [ ] `isDefault=true`인 대시보드 조회 확인
   - [ ] 기본 대시보드가 표시되는지 확인
   - [ ] 또는 레거시 폴백 동작 확인

**예상 결과**:
- 비활성화된 대시보드는 조회되지 않음
- 기본 대시보드 또는 레거시 폴백으로 대시보드 표시

---

### 케이스 3: 역할 정보가 없는 경우

**전제 조건**:
- `currentTenantRole`이 없는 사용자 (레거시 사용자 또는 세션 오류)

**테스트 단계**:

1. **역할 정보 없음 시나리오**
   - [ ] `currentTenantRole`이 `null`인 사용자로 로그인
   - [ ] 또는 세션에서 역할 정보가 손실된 경우 시뮬레이션

2. **레거시 역할 기반 라우팅 동작 확인**
   - [ ] 콘솔에서 "⚠️ 레거시 대시보드 라우팅" 로그 확인
   - [ ] `user.role` 기반으로 레거시 경로 계산 확인
   - [ ] 레거시 대시보드 컴포넌트 표시 확인

**예상 결과**:
- 역할 정보가 없을 때 `user.role` 기반 레거시 라우팅 동작
- 사용자에게 오류 없이 대시보드 표시

---

## 🔍 API 테스트

### 백엔드 API 직접 테스트

**필요한 도구**: Postman, curl, 또는 브라우저 개발자 도구

1. **현재 사용자 대시보드 조회**
   ```bash
   GET /api/v1/tenant/dashboards/current
   Headers: Cookie: JSESSIONID=...
   ```
   - [ ] 인증된 사용자로 요청 시 200 응답
   - [ ] 응답 데이터 구조 확인
   - [ ] 비인증 사용자로 요청 시 401 응답

2. **역할별 대시보드 조회**
   ```bash
   GET /api/v1/tenant/dashboards/by-role/{tenantRoleId}
   Headers: Cookie: JSESSIONID=...
   ```
   - [ ] 유효한 `tenantRoleId`로 요청 시 200 응답
   - [ ] 존재하지 않는 `tenantRoleId`로 요청 시 404 응답
   - [ ] 다른 테넌트의 `tenantRoleId`로 요청 시 403 응답

3. **대시보드 목록 조회**
   ```bash
   GET /api/v1/tenant/dashboards
   Headers: Cookie: JSESSIONID=...
   ```
   - [ ] 현재 테넌트의 모든 대시보드 목록 반환
   - [ ] 활성화된 대시보드만 반환되는지 확인

---

## 📊 성능 테스트

1. **대시보드 조회 응답 시간**
   - [ ] Network 탭에서 API 응답 시간 확인
   - [ ] 500ms 이내 응답 확인 (목표)

2. **대시보드 컴포넌트 로딩 시간**
   - [ ] 대시보드 컴포넌트 렌더링 시간 확인
   - [ ] 1초 이내 렌더링 확인 (목표)

3. **캐싱 동작 확인**
   - [ ] 같은 역할로 재접근 시 API 재호출 여부 확인
   - [ ] 세션에 대시보드 정보 캐싱 확인 (향후 구현)

---

## 🐛 알려진 이슈 확인

1. **OAuth2Callback에서 역할 정보 부족**
   - [ ] OAuth2 로그인 후 `currentTenantRole`이 올바르게 설정되는지 확인
   - [ ] 세션에서 역할 정보를 가져오는 로직 동작 확인

2. **레거시 라우팅과의 충돌**
   - [ ] 모든 레거시 라우트가 `DynamicDashboard`로 변경되었는지 확인
   - [ ] 라우트 우선순위 확인

---

## 📝 테스트 결과 기록

### 테스트 환경
- **날짜**: 
- **테스터**: 
- **브라우저**: Chrome / Firefox / Safari
- **백엔드 버전**: 
- **프론트엔드 버전**: 

### 테스트 결과 요약

| 시나리오 | 결과 | 비고 |
|---------|------|------|
| 시나리오 1: 단일 테넌트 사용자 로그인 | ⬜ 통과 / ⬜ 실패 | |
| 시나리오 2: 멀티 테넌트 사용자 | ⬜ 통과 / ⬜ 실패 | |
| 시나리오 3: 소셜 로그인 | ⬜ 통과 / ⬜ 실패 | |
| 시나리오 4: 온보딩 후 기본 대시보드 | ⬜ 통과 / ⬜ 실패 | |
| 케이스 1: 대시보드가 없는 경우 | ⬜ 통과 / ⬜ 실패 | |
| 케이스 2: 비활성화된 대시보드 | ⬜ 통과 / ⬜ 실패 | |
| 케이스 3: 역할 정보가 없는 경우 | ⬜ 통과 / ⬜ 실패 | |

### 발견된 이슈

1. **이슈 1**: 
   - 설명: 
   - 재현 단계: 
   - 우선순위: 높음 / 중간 / 낮음

2. **이슈 2**: 
   - 설명: 
   - 재현 단계: 
   - 우선순위: 높음 / 중간 / 낮음

---

## ✅ 테스트 완료 기준

- [ ] 모든 시나리오 통과
- [ ] 모든 에러 케이스에서 폴백 동작 확인
- [ ] API 응답 시간 목표 달성
- [ ] 알려진 이슈 해결 또는 문서화
- [ ] 테스트 결과 문서화 완료

---

**참고**: 이 체크리스트는 시스템 재부팅 후 실제 환경에서 테스트할 때 사용합니다.

