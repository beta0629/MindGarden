<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>MindGarden - 테블릿 로그인</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- 공통 CSS -->
    <link rel="stylesheet" th:href="@{/css/variables.css}">
    <link rel="stylesheet" th:href="@{/css/common.css}">
    <link rel="stylesheet" th:href="@{/css/components.css}">
    <link rel="stylesheet" th:href="@{/css/tablet.css}">
    <link rel="stylesheet" th:href="@{/css/tablet-common.css}">
    
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
    
    <!-- 공통 JavaScript -->
    <script th:src="@{/js/common/utils.js}"></script>
    <script th:src="@{/js/common/ajax.js}"></script>
    <script th:src="@{/js/common/router.js}"></script>
    <script th:src="@{/js/common/components.js}"></script>
    <script th:src="@{/js/tablet/tablet.js}"></script>
</head>
<body class="tablet-login-page tablet-page" style="display: flex; flex-direction: column; min-height: 100vh; min-width: 768px; max-width: 1024px; margin: 0 auto;">
    
    <!-- 테블릿 햄버거 메뉴 네비게이션 -->
    <div th:replace="~{common/components/tablet-navigation :: tablet-header}">
        <!-- 햄버거 메뉴 헤더 -->
    </div>
    
    <!-- 메인 컨텐츠 -->
    <main class="tablet-main">
        <div class="tablet-container">
            <!-- 로그인 폼 섹션 -->
            <div class="login-form-section">
                <div class="form-container">
                    <h2 class="form-title">로그인</h2>
                    <p class="form-subtitle">계정에 로그인하여 서비스를 이용하세요</p>
                    
                    <form id="loginForm" class="login-form" th:action="@{/api/auth/login}" method="post">
                        <div class="form-group">
                            <label for="email" class="form-label">이메일</label>
                            <div class="input-wrapper">
                                <div class="input-icon">
                                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                        <path d="M2.5 5.83333C2.5 4.91286 3.24619 4.16667 4.16667 4.16667H15.8333C16.7538 4.16667 17.5 4.91286 17.5 5.83333V14.1667C17.5 15.0871 16.7538 15.8333 15.8333 15.8333H4.16667C3.24619 15.8333 2.5 15.0871 2.5 14.1667V5.83333Z" stroke="var(--secondary-400)" stroke-width="1.5"/>
                                        <path d="M17.5 5.83333L10 10.8333L2.5 5.83333" stroke="var(--secondary-400)" stroke-width="1.5"/>
                                    </svg>
                                </div>
                                <input type="email" id="email" name="email" class="form-input" placeholder="이메일을 입력하세요" required>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="password" class="form-label">비밀번호</label>
                            <div class="input-wrapper">
                                <div class="input-icon">
                                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                        <path d="M15 8.33333V6.66667C15 4.08934 12.9107 2 10.3333 2C7.756 2 5.66667 4.08934 5.66667 6.66667V8.33333" stroke="var(--secondary-400)" stroke-width="1.5"/>
                                        <rect x="3.33333" y="8.33333" width="14" height="9.66667" rx="1" stroke="var(--secondary-400)" stroke-width="1.5"/>
                                        <circle cx="10" cy="13" r="1" fill="var(--secondary-400)"/>
                                    </svg>
                                </div>
                                <input type="password" id="password" name="password" class="form-input" placeholder="비밀번호를 입력하세요" required>
                                <button type="button" class="password-toggle" onclick="togglePassword()">
                                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                        <path d="M10 4.16667C6.25 4.16667 3.33333 6.66667 2.5 10C3.33333 13.3333 6.25 15.8333 10 15.8333C13.75 15.8333 16.6667 13.3333 17.5 10C16.6667 6.66667 13.75 4.16667 10 4.16667Z" stroke="var(--secondary-400)" stroke-width="1.5"/>
                                        <circle cx="10" cy="10" r="2.5" stroke="var(--secondary-400)" stroke-width="1.5"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        
                        <div class="form-options">
                            <label class="checkbox-wrapper">
                                <input type="checkbox" id="rememberMe" name="rememberMe">
                                <span class="checkmark"></span>
                                로그인 상태 유지
                            </label>
                            <a href="#" class="forgot-password">비밀번호 찾기</a>
                        </div>
                        
                        <button type="submit" class="login-button">
                            <span class="button-text">로그인</span>
                            <div class="button-icon">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                    <path d="M3.33333 10H16.6667M16.6667 10L11.6667 5M16.6667 10L11.6667 15" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </div>
                        </button>
                    </form>
                    
                    <div class="divider">
                        <span>또는</span>
                    </div>
                    
                    <div class="social-login">
                        <button class="social-button kakao" onclick="kakaoLogin()">
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                <path d="M10 2C5.58172 2 2 5.58172 2 10C2 14.4183 5.58172 18 10 18C14.4183 18 18 14.4183 18 10C18 5.58172 14.4183 2 10 2Z" fill="#FEE500"/>
                                <path d="M10 6C7.79086 6 6 7.79086 6 10C6 12.2091 7.79086 14 10 14C12.2091 14 14 12.2091 14 10C14 7.79086 12.2091 6 10 6Z" fill="#FEE500"/>
                            </svg>
                            카카오로 로그인
                        </button>
                        
                        <button class="social-button naver" onclick="naverLogin()">
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                <rect width="20" height="20" rx="2" fill="#03C75A"/>
                                <path d="M6 6L14 14M14 6L6 14" stroke="white" stroke-width="2"/>
                            </svg>
                            네이버로 로그인
                        </button>
                    </div>
                    
                    <div class="signup-link">
                        <p>계정이 없으신가요? <a href="/tablet/register" class="link">회원가입</a></p>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <!-- 공통 모달 컴포넌트들 -->
    <div th:replace="~{common/components/social-signup-modal :: social-signup-modal}">
        <!-- 소셜 회원가입 모달 -->
    </div>
    
    <div th:replace="~{common/components/notification :: notification}">
        <!-- 알림 컴포넌트 -->
    </div>
    
    <script>
    // 비밀번호 표시/숨김 토글
    function togglePassword() {
        const passwordInput = document.getElementById('password');
        const passwordToggle = document.querySelector('.password-toggle');
        
        if (passwordInput.type === 'password') {
            passwordInput.type = 'text';
            passwordToggle.innerHTML = `
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                    <path d="M2.5 5.83333C2.5 4.91286 3.24619 4.16667 4.16667 4.16667H15.8333C16.7538 4.16667 17.5 4.91286 17.5 5.83333V14.1667C17.5 15.0871 16.7538 15.8333 15.8333 15.8333H4.16667C3.24619 15.8333 2.5 15.0871 2.5 14.1667V5.83333Z" stroke="var(--secondary-400)" stroke-width="1.5"/>
                    <path d="M17.5 5.83333L10 10.8333L2.5 5.83333" stroke="var(--secondary-400)" stroke-width="1.5"/>
                </svg>
            `;
        } else {
            passwordInput.type = 'password';
            passwordToggle.innerHTML = `
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                    <path d="M10 4.16667C6.25 4.16667 3.33333 6.66667 2.5 10C3.33333 13.3333 6.25 15.8333 10 15.8333C13.75 15.8333 16.6667 13.3333 17.5 10C16.6667 6.66667 13.75 4.16667 10 4.16667Z" stroke="var(--secondary-400)" stroke-width="1.5"/>
                    <circle cx="10" cy="10" r="2.5" stroke="var(--secondary-400)" stroke-width="1.5"/>
                </svg>
            `;
        }
    }
    
    // OAuth2 설정 가져오기
    async function getOAuth2Config() {
        try {
            const response = await fetch('/api/auth/oauth2/config');
            if (response.ok) {
                const config = await response.json();
                window.oauth2Config = config;
            }
        } catch (error) {
            console.error('OAuth2 설정을 가져오는데 실패했습니다:', error);
        }
    }
    
    // 카카오 로그인
    async function kakaoLogin() {
        if (!window.oauth2Config?.kakao?.clientId) {
            console.error('카카오 OAuth2 설정이 없습니다.');
            return;
        }
        
        const clientId = window.oauth2Config.kakao.clientId;
        const redirectUri = encodeURIComponent(window.oauth2Config.kakao.redirectUri);
        const scope = window.oauth2Config.kakao.scope;
        
        const kakaoAuthUrl = `https://kauth.kakao.com/oauth/authorize?client_id=${clientId}&redirect_uri=${redirectUri}&response_type=code&scope=${scope}`;
        
        window.location.href = kakaoAuthUrl;
    }
    
    // 네이버 로그인
    async function naverLogin() {
        if (!window.oauth2Config?.naver?.clientId) {
            console.error('네이버 OAuth2 설정이 없습니다.');
            return;
        }
        
        const clientId = window.oauth2Config.naver.clientId;
        const redirectUri = encodeURIComponent(window.oauth2Config.naver.redirectUri);
        const state = Math.random().toString(36).substring(2, 15);
        
        // state를 세션에 저장 (보안을 위해)
        sessionStorage.setItem('naver_oauth_state', state);
        
        const naverAuthUrl = `https://nid.naver.com/oauth2.0/authorize?client_id=${clientId}&redirect_uri=${redirectUri}&response_type=code&state=${state}`;
        
        window.location.href = naverAuthUrl;
    }
    
    // 페이지 로드 시 OAuth2 설정 가져오기
    document.addEventListener('DOMContentLoaded', function() {
        getOAuth2Config();
    });
    </script>
</body>
</html>
