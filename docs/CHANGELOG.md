# Changelog

All notable changes to this project will be documented in this file.

## [2025-09-16] - 스케줄 UI 개선 및 한글 인코딩 문제 해결

### 🎨 스케줄 등록 UI 개선
- **시간 선택 그리드 디자인 개선**
  - 인라인 스타일 적용으로 CSS 충돌 문제 해결
  - 색상 원 아이콘으로 상태 표시 개선 (이모지 대신)
  - 반응형 레이아웃 및 호버 효과 추가

- **드롭다운 메뉴 개선**
  - 상담 유형 및 상담 시간 선택 드롭다운 스타일링
  - 포커스 상태 및 선택 상태 시각적 피드백 개선
  - 접근성 향상 (키보드 네비게이션 지원)

### 🌐 한글 인코딩 문제 해결
- **데이터베이스 문자 인코딩 수정**
  - MySQL 클라이언트 UTF-8 설정으로 한글 데이터 재저장
  - 공통 코드 테이블의 한글 라벨 정상화
  - 상담 유형: 개인상담, 가족상담, 부부상담, 초기상담, 집단상담
  - 상담 시간: 30분, 50분, 60분, 80분, 90분, 100분, 120분, 사용자 정의

- **프론트엔드 폰트 설정**
  - Google Fonts Noto Sans KR 폰트 로드 추가
  - 한글 폰트 패밀리 우선순위 설정
  - 모든 텍스트 요소에 한글 폰트 적용

### 🔧 기술적 개선사항
- **아이콘 시스템 개선**
  - 이모지 아이콘 제거로 인코딩 문제 해결
  - 색상 원과 한글 텍스트로 상태 표시
  - 시각적 일관성 및 안정성 향상

- **인라인 스타일 적용**
  - CSS 클래스 의존성 제거
  - 동적 스타일링으로 유연성 증대
  - 브라우저 호환성 개선

## [2025-09-16] - 스케줄 시스템 중앙화 및 대시보드 UI 개선

### 📅 스케줄 시스템 중앙화
- **API 통합 및 중복 제거**
  - ConsultantController의 스케줄 API를 ScheduleController로 통합
  - BranchScheduleService를 ScheduleService에 통합하여 중앙 관리
  - 스케줄 관련 API 엔드포인트 중앙화

- **하드코딩 제거 및 동적 시스템**
  - BranchStatisticsServiceImpl과 BranchDataFilterServiceImpl에서 공통 코드 사용
  - commonCodeUtils.js 생성으로 프론트엔드 하드코딩 제거
  - 동적 데이터 관리 시스템 구축

- **오류 해결 및 안정성 개선**
  - 스케줄 API 400 오류 및 StaleStateException 해결
  - 시간 슬롯 충돌 검사 기능 구현 (예약된 시간대 비활성화)
  - 상담사 이름 표시 개선 (스케줄 상세정보 및 휴가 이벤트)

### 🎨 대시보드 UI/UX 개선
- **오늘의 상담 위젯 개선**
  - 2열 그리드 레이아웃으로 최대 8개 상담 효율적 표시
  - 스크롤 기능 개선으로 많은 상담 처리 가능
  - 반응형 카드 디자인으로 컴팩트하고 직관적인 UI

- **데이터 표시 문제 해결**
  - 대시보드에서 오늘의 상담이 표시되지 않는 문제 수정
  - 날짜 비교 로직 개선으로 정확한 필터링
  - 상담사 이름 및 클라이언트 정보 정상 표시

### 🔧 기술적 개선사항
- **프론트엔드 최적화**
  - 인라인 스타일 적용으로 CSS 충돌 방지
  - 호버 효과 및 트랜지션 추가
  - 접근성 개선 및 사용자 경험 향상

- **백엔드 안정성**
  - 낙관적 락킹을 통한 동시성 문제 해결
  - 트랜잭션 관리 개선
  - 오류 처리 및 로깅 강화

## [2025-09-16] - 프리랜서 세금 시스템 개선 및 사업자 등록 기능 추가

### 🏢 사업자 등록 시스템 구현
- **ConsultantSalaryProfile 엔티티 확장**
  - `businessRegistrationNumber` 필드 추가 (사업자 등록번호)
  - `businessName` 필드 추가 (사업자명)
  - Hibernate 자동 테이블 스키마 업데이트

- **세금 계산 로직 개선**
  - **일반 프리랜서**: 원천징수세 3.3% + 지방소득세 0.33%
  - **사업자 등록**: 원천징수세 3.3% + 지방소득세 0.33% + 부가가치세 10%
  - 4대보험은 연간 1,200만원 이상 시에만 적용
  - 상담사별 사업자 등록 여부에 따른 자동 세금 방식 선택

### 🔧 백엔드 API 개선
- **급여 프로필 생성 API 확장**
  - 사업자 등록번호 및 사업자명 처리
  - 유효성 검사 로직 추가
  - 기존 API 호환성 유지

- **세금 통계 API 개선**
  - 원천징수세와 부가가치세 구분 표시
  - 사업자 등록 여부에 따른 세금 항목 동적 표시
  - 프리랜서 세금 체계에 맞는 정확한 계산

### 🎨 프론트엔드 UI 개선
- **상담사 프로필 모달 개선**
  - 사업자 등록 시 필수 필드 입력 (등록번호, 사업자명)
  - 사업자 등록번호 형식 유효성 검사 (123-45-67890)
  - 조건부 필드 표시 (사업자 등록 시에만 추가 필드 표시)

- **세금 관리 화면 개선**
  - 원천징수세와 부가가치세 구분 표시
  - 사업자 등록 여부에 따른 세금 항목 동적 표시
  - 프리랜서 세금 체계에 맞는 명확한 세금 내역

### 🐛 버그 수정
- **세금 계산 오류 해결**
  - 기간 선택 없이 세금 통계 조회 시 경고 메시지 표시
  - 기간 선택 시 자동 세금 통계 로드 기능 추가
  - 세금 관리 탭 전환 시 자동 데이터 로드

- **데이터 일관성 개선**
  - 사업자 등록 정보와 세금 계산 로직 연동
  - 상담사별 개별 세금 방식 적용
  - 정확한 세금 계산을 위한 데이터 검증

## [2025-09-15] - 시스템 관리 도구 UI 개선

### 🎨 UI/UX 개선
- **SystemTools 컴포넌트 스타일 개선**
  - 테두리 색상 제거로 더 깔끔한 디자인 구현
  - 파스텔 톤 그라데이션 배경 유지
  - 호버 효과에서 테두리 관련 스타일 제거
  - 카드 형태의 버튼 디자인 최적화

### 🔧 기술적 개선
- **인라인 스타일 적용**
  - CSS 충돌 방지를 위한 인라인 스타일 전환
  - 각 도구별 고유한 색상 테마 유지
  - 반응형 호버 효과 구현

## [2025-09-15] - 내담자 관리 시스템 개선 및 UI 최적화

### 🔧 개선사항
- **내담자 관리 페이지 UI 개선**
  - 중복된 필터 UI 제거로 깔끔한 인터페이스 구현
  - 통합된 필터 시스템으로 사용자 경험 향상
  - 최신순 10명 기본 노출, 필터 적용 시 전체 표시

- **등급 한글 매핑 오류 수정**
  - "알 수 없음" 표시 문제 해결
  - getStatusTextSync → getGradeTextSync 함수 변경
  - 백엔드 API에 grade 필드 추가

- **필터 기능 강화**
  - 이름, 이메일, 전화번호 통합 검색 기능
  - 상태별 필터링 (활성, 비활성, 일시정지 등)
  - 필터 초기화 버튼 및 상태 표시
  - 실시간 검색 결과 카운트 표시

- **성능 최적화**
  - 기본적으로 최신 10명만 로드하여 성능 향상
  - 필터 적용 시에만 전체 데이터 표시
  - 최신순 정렬 (createdAt 기준)

### 🐛 버그 수정
- **Promise 객체 렌더링 오류 해결**
  - async 함수를 JSX에서 직접 호출하는 문제 수정
  - 동기식 fallback 함수 구현 (getStatusTextSync, getGradeTextSync, getGradeIconSync)
  - undefined 값 처리로 TypeError 방지

- **React Key 중복 오류 해결**
  - mappingStatusOptions에서 중복 제거 로직 개선
  - 고유한 key 값 생성으로 React 렌더링 안정성 향상

### 📊 데이터 개선
- **백엔드 API 개선**
  - getAllClientsWithMappingInfo()에 grade 필드 추가
  - 클라이언트 데이터에 등급 정보 포함
  - null 값 처리로 안정성 향상

## [2025-09-15] - 스케줄 관리 시스템 개선 및 UI 최적화

### 🔧 개선사항
- **스케줄 페이지 무한루프 문제 해결**
  - useEffect 의존성 배열 최적화로 무한루프 방지
  - 상담사 권한 체크 로직 개선 (기본 접근 권한 부여)
  - 권한 체크는 관리자에게만 적용하여 성능 향상

- **로그 시스템 정리**
  - 불필요한 console.log 제거로 로그 스팸 방지
  - 에러 로그만 유지하여 디버깅 효율성 향상
  - 개발 환경에서의 콘솔 오염 방지

- **상담사 대시보드 회기수 표시 개선**
  - 내담자별 누적 회기수 계산 로직 구현
  - 여러 매핑의 회기수를 합산하여 정확한 총 회기수 표시
  - 내담자 대시보드와 동일한 계산 로직으로 일관성 확보
  - 클라이언트별 그룹화를 통한 중복 제거

- **데이터 일관성 향상**
  - 상담사와 내담자 대시보드 간 회기수 표시 일치
  - 패키지별 상세 정보 보존 및 누적 계산
  - 최근 상담일 자동 업데이트 로직 개선

## [2025-09-15] - UI/UX 개선 및 상담 가이드 모달 구현

### ✨ 새로운 기능
- **상담 가이드 모달 시스템**
  - 상담 전 준비사항, 상담 중 주의사항, 효과적인 상담 팁 제공
  - 기술적 준비사항 안내 (인터넷 연결, 카메라/마이크 확인 등)
  - 자주 묻는 질문(FAQ) 섹션 포함
  - 인라인 스타일로 CSS 충돌 방지

- **페이지 헤드라인 시스템**
  - 회기 관리 및 결제 내역 상세 페이지에 그라데이션 헤드라인 추가
  - 아이콘과 설명 텍스트가 포함된 중앙 정렬 디자인
  - 일관된 시각적 계층 구조 제공

### 🎨 UI/UX 개선
- **파스텔톤 색상 적용**
  - 통계 카드 아이콘을 그라데이션에서 파스텔톤 연한 색상으로 변경
  - 시각적 피로도 감소 및 가독성 향상
  - 일관된 색상 체계 적용

- **중복 카드 정리**
  - 대시보드에서 중복된 "회기 현황" 카드 제거
  - "회기 관리" 카드만 유지하여 UI 정리

- **CSS 충돌 해결**
  - 상담 가이드 모달을 인라인 스타일로 변경
  - 공통 스타일과의 충돌 완전 해결
  - 컴포넌트 독립성 확보

### 🔧 개선사항
- **모달 시스템 개선**
  - 상담 가이드 모달의 반응형 디자인 지원
  - 호버 효과 및 인터랙션 개선
  - 접근성 고려한 키보드 네비게이션

- **페이지 구조 개선**
  - 상세 페이지의 명확한 헤더 구조
  - 사용자 경험 향상을 위한 시각적 가이드

## [2025-09-15] - 회기 관리 시스템 개선 및 결제 참조번호 자동 생성

### ✨ 새로운 기능
- **회기 추가 요청 워크플로우 완성**
  - 입금 확인 → 관리자 승인 → 요청 완료 3단계 프로세스
  - 결제 방법별 자동 참조번호 생성 (CASH_, CARD_, BANK_ 접두사)
  - 실시간 참조번호 생성 및 수정 가능한 UI
  - 요청 완료 버튼 추가로 전체 워크플로우 완성

### 🔧 개선사항
- **결제 참조번호 자동 생성 시스템**
  - 모든 결제 방법에 대해 자동 참조번호 생성
  - 타임스탬프 기반 고유 참조번호 (`YYYYMMDD_HHMMSS` 형식)
  - 결제 방법 변경 시 실시간 자동 업데이트
  - 사용자 수정 가능한 유연한 시스템

- **회기 동기화 시스템 강화**
  - SessionSyncService를 통한 회기 추가/사용 후 전체 시스템 동기화
  - 동일한 상담사-클라이언트 매핑 간 자동 동기화
  - 회기 수 일관성 검증 및 자동 수정 기능

### 🛠️ 기술적 개선
- **프론트엔드 개선**
  - 결제 방법 변경 시 자동 참조번호 생성 useEffect 추가
  - 모든 결제 방법에 대한 통합 참조번호 생성 로직
  - 사용자 친화적인 UI 메시지 및 플레이스홀더

- **백엔드 개선**
  - SessionExtensionServiceImpl에서 현금 결제 시 참조번호 null 허용
  - SessionSyncServiceImpl에서 회기 추가 로직 중앙화
  - 완료된 요청에 대한 요청 완료 버튼 API 추가

### 🐛 버그 수정
- 현금 결제 시 참조번호 필수 검증 제거
- 결제 방법별 참조번호 생성 로직 통합
- 회기 추가 후 시스템 전체 동기화 보장

## [2025-09-15] - ERP 시스템 구축 완료

### ✨ 새로운 기능
- **ERP 시스템 구축 완료**
  - 구매 관리 페이지 (`/erp/purchase`) - 비품 구매 요청 및 주문 관리
  - 재무 관리 페이지 (`/erp/financial`) - 재무 거래 및 회계 관리
  - ERP 공통 CSS 시스템 - 격리된 네임스페이스로 CSS 충돌 방지
  - ERP 메뉴 시스템 - CommonCode 기반 동적 메뉴 구조
  - ERP 권한 시스템 - 역할별 세분화된 권한 관리

### 🔧 개선사항
- **AdminController 확장**
  - FinancialTransaction API 추가 (`/api/admin/financial-transactions`)
  - 메뉴 API 개선 (`/api/admin/menus`)
- **데이터 정리**
  - 결제 상태 코드 중복 데이터 정리 (7개 중복 항목 제거)
- **권한 시스템 강화**
  - HQ_MASTER: 모든 ERP 권한
  - BRANCH_SUPER_ADMIN: 구매/재무 관리 권한
  - BRANCH_ADMIN: 구매 관리 조회 권한

### 🛠️ 기술적 개선
- **CSS 격리**: `.erp-system` 네임스페이스로 CSS 충돌 방지
- **권한 코드**: 8개 ERP 권한 코드 추가
- **역할 매핑**: 8개 역할별 권한 매핑 추가
- **메뉴 통합**: CommonCode 기반 ERP 메뉴 구조

## [2025-09-14] - 상담기록 시스템 개선 및 데이터 일관성 강화

### 🔧 상담기록 시스템 개선
- **상담기록 조회 전용 페이지 분리**
  - `ConsultationRecordView.js` 새로 생성 - 조회 전용 페이지
  - 작성용(`/consultant/consultation-record/:consultationId`)과 조회용(`/consultant/consultation-record-view/:recordId`) 라우팅 분리
  - 상담기록 상세 조회 API 추가 (`GET /api/consultant/{consultantId}/consultation-records/{recordId}`)

- **상태 필터 옵션 최적화**
  - 상담기록에 적합한 상태만 필터링 (완료, 대기, 전체)
  - 활성/비활성 등 부적절한 상태 옵션 제거
  - 기본 선택 상태를 '완료'로 변경

- **오류 처리 및 사용자 경험 개선**
  - 구체적인 오류 메시지 제공 (401, 403, 404, 500 등)
  - 재시도 기능 개선 (로딩 상태, 스피닝 애니메이션)
  - React 오류 수정 (`Cannot read properties of null`)

### 🛡️ 데이터 일관성 시스템 구축
- **데이터 검증 및 정리 도구**
  - 데이터 일관성 검증 API (`GET /api/consultant/{consultantId}/data-consistency-check`)
  - 불일치 데이터 자동 정리 API (`POST /api/consultant/{consultantId}/cleanup-inconsistent-data`)
  - 상담기록 생성 시 스케줄 검증 로직 추가

- **상태 동기화 메커니즘**
  - 상담 완료 시 스케줄 상태 자동 동기화
  - `ScheduleRepository.findByConsultationId` 메서드 추가
  - 데이터 불일치 방지 및 자동 복구 시스템

### 🎨 UI/UX 개선
- **상담기록 페이지 디자인 개선**
  - 조회 전용 페이지로 명확한 역할 분리
  - 깔끔한 상담기록 상세 표시 UI
  - 상태별 버튼 및 배지 렌더링 개선

- **필터링 시스템 최적화**
  - 상담기록에 맞는 상태 옵션만 표시
  - 프론트엔드 상태별 필터링 활성화
  - 백엔드 필터링 제거로 유연성 증대

## [2025-09-14] - ERP 메뉴 시스템 구축 및 동적 역할 관리

### 🏢 새로운 기능
- **ERP 메뉴 시스템 구축**
  - BRANCH_SUPER_ADMIN 전용 ERP 메뉴 그룹 생성
  - 구매 관리, 예산 관리, 재무 관리, ERP 보고서 등 5개 서브메뉴 추가
  - `/admin/erp/*` 경로로 ERP 페이지 라우팅 연결

- **동적 역할 표시명 시스템**
  - 하드코딩된 역할 표시명을 백엔드 API 기반 동적 로딩으로 전환
  - `GET /api/admin/user-roles` 엔드포인트 추가
  - 10분 캐싱 메커니즘 및 Fallback 처리 구현

### 🔐 권한 시스템 고도화
- **HQ_MASTER 전체 권한 부여**
  - 최고 관리자에게 모든 메뉴 그룹 접근 권한 부여 (47개 메뉴)
  - 다중 메뉴 그룹 지원으로 역할별 권한 세분화

- **역할별 메뉴 분리**
  - ADMIN_MENU, BRANCH_SUPER_ADMIN_MENU, HQ_ADMIN_MENU 등 역할별 메뉴 그룹 분리
  - 권한 기반 메뉴 접근 제어 강화

### 🐛 버그 수정
- **API 엔드포인트 오류 해결**
  - `/api/admin/users/{id}` 엔드포인트 추가로 500 오류 해결
  - `/api/admin/users/{id}/social-accounts` 엔드포인트 추가

- **Jackson 직렬화 오류 해결**
  - Hibernate 프록시 객체 JSON 변환 오류 수정
  - Branch 엔티티에 `@JsonIgnoreProperties` 어노테이션 추가

- **역할 표시명 수정**
  - `superadmin@mindgarden.com` 계정의 역할 표시명 "본점수퍼어드민"으로 수정
  - 프론트엔드 하드코딩된 역할 매핑 제거

- **날짜 선택기 개선**
  - 상담 완료 통계 페이지의 날짜 변경 기능 디버깅 및 개선
  - 현재 월 기본값 설정 및 API 응답 로깅 추가

### 🔒 보안 강화
- **보안 취약점 분석**
  - 전체 코드베이스에서 하드코딩된 민감한 데이터 검색 완료
  - OAuth2 클라이언트 시크릿, API 키, 관리자 계정 정보 등 하드코딩 발견
  - 상담 시스템 특성에 맞는 현실적인 보안 수준 설정

- **보안 계획 수립**
  - SECURITY_TODO.md 생성으로 보안 강화 로드맵 수립
  - 우선순위별 보안 개선 항목 정의
  - 토스 결제 연계 시 함께 진행할 보안 강화 계획 수립
  - 카카오 알림톡 연계 시 함께 진행할 보안 강화 계획 수립

### 📱 새로운 기능 계획
- **카카오 알림톡 연동 시스템 계획**
  - 상담 예약, 취소, 완료 등에 대한 카카오 알림톡 발송 시스템 계획
  - 알림톡 템플릿 관리 및 발송 로그 시스템 계획
  - 개인정보 보호를 위한 알림톡 보안 강화 계획

## [2025-09-14] - 429 오류 해결 및 시스템 최적화

### 🐛 버그 수정
- **429 Too Many Requests 오류 완전 해결**
  - ClientSelector 컴포넌트의 개별 내담자 API 호출 문제 해결
  - MappingCard 컴포넌트의 개별 상태 정보 API 호출 문제 해결
  - RateLimitingFilter 임계값을 초당 100 → 200 요청으로 증가 (개발 환경)

### ⚡ 성능 개선
- **API 호출 최적화**
  - 개별 API 호출을 일괄 처리로 변경
  - API 호출 횟수 대폭 감소 (N * 3번 → 1번)
  - 네트워크 트래픽 최적화

- **데이터 로딩 패턴 개선**
  - ClientSelector: `loadAllClientMappings` 함수로 상담사별 매핑 정보 일괄 조회
  - MappingManagement: `loadMappingStatusInfo` 함수로 매핑 상태 정보 일괄 로드
  - Props 기반 데이터 전달 구조로 컴포넌트 간 효율적 데이터 공유

### 🔧 기술적 개선
- **에러 핸들링 강화**
  - API 실패 시 기본값 설정 메커니즘
  - 폴백 데이터 구조 개선
  - 사용자 경험 향상을 위한 안정적인 동작 보장

- **컴포넌트 구조 개선**
  - MappingCard에서 개별 API 호출 제거
  - 상태 정보를 props로 받아 사용하는 구조로 변경
  - 불필요한 useEffect 및 useState 제거

## [2025-01-11] - 내담자 대시보드 개인화 및 UX 개선

### 🆕 새로운 기능
- **내담자 맞춤형 메시지 시스템**
  - 매핑 상태, 상담 진행 상황, 결제 상태 기반 동적 메시지 생성
  - 신규 내담자, 대기 중, 활성 매핑, 완료된 상담 등 상황별 맞춤 메시지
  - 실시간 날씨 정보 통합 (OpenWeatherMap API)
  - 일일 팁 시스템 (7가지 팁 순환)

- **내담자 대시보드 개선**
  - "오늘의 상담" 큰 카드로 중요 정보 강조
  - 그라데이션 배경과 반투명 효과로 시각적 임팩트
  - 상담 일정 상세 정보 표시 (시간, 상담사, 상태)
  - 중복 카드 제거로 깔끔한 UI

- **상담사 목록 모달**
  - 상담사가 있으면 목록을 모달로 표시
  - 상담사가 없으면 안내 메시지와 연결 권유
  - 반응형 디자인으로 모바일 지원

- **내담자 빠른 액션 페이지**
  - 일정 페이지 (`/client/schedule`): 풀 캘린더 뷰
  - 도움말 페이지 (`/help`): 카테고리별 도움말
  - 설정 페이지 (`/client/settings`): 알림, 개인정보, 언어 설정

### 🔧 개선사항
- **공통 헤더 개선**
  - 조건부 뒤로가기 버튼 추가
  - 동적 제목 설정 지원
  - 중복 헤더 문제 해결

- **OAuth2 로그인 개선**
  - JWT secret key Base64 오류 수정
  - OAuth2 리다이렉트 URL 동적 처리
  - Referer 헤더 null 값 필터링
  - 프로퍼티 기반 프론트엔드 URL 설정

- **API 오류 해결**
  - 내담자 매핑 API 500 에러 임시 해결
  - 기본값 설정으로 대시보드 안정성 향상

### 📝 기술적 변경사항
- **새로운 컴포넌트**:
  - `ClientPersonalizedMessages.js`: 내담자 맞춤형 메시지 시스템
  - `WeatherCard.js`: 실시간 날씨 정보 표시
  - `ConsultantListModal.js`: 상담사 목록 모달
  - `ClientSchedule.js`: 내담자 일정 페이지
  - `HelpPage.js`: 도움말 페이지
  - `ClientSettings.js`: 내담자 설정 페이지

- **수정된 컴포넌트**:
  - `SimpleHeader.js`: 뒤로가기 버튼 및 동적 제목 지원
  - `SimpleLayout.js`: 제목 prop 전달 지원
  - `WelcomeSection.js`: 내담자용 큰 상담 카드
  - `CommonDashboard.js`: 중복 제거 및 API 오류 처리
  - `ClientPersonalizedMessages.js`: 클릭 핸들러 및 모달 통합

- **설정 파일 업데이트**:
  - `application-local.yml`: JWT secret, 암호화 키, 프론트엔드 URL
  - `application-prod.yml`: 프로덕션 프론트엔드 URL
  - `application.yml`: 기본 프론트엔드 URL

### 🐛 버그 수정
- OAuth2 로그인 시 `http://null/client/dashboard` 리다이렉트 오류
- 네이버 로그인 JWT 토큰 검증 실패
- 내담자 대시보드 API 500 에러
- 중복 카드 렌더링 문제
- 불필요한 "자세히 보기" 링크 표시

### 🎨 UI/UX 개선
- 연한 파스텔톤 색상 테마 적용
- 카드 호버 효과 및 트랜지션
- 반응형 그리드 레이아웃
- 인라인 CSS 스타일링
- 컴포넌트 재사용성 향상

## [2025-01-11] - 재무 거래 공통 코드 시스템 구축

### 🆕 새로운 기능
- **재무 거래 공통 코드 시스템**
  - 재무 거래 관련 모든 항목을 공통 코드로 관리
  - 거래 유형: INCOME, EXPENSE
  - 수입 카테고리: 상담료, 패키지, 기타수입
  - 지출 카테고리: 급여, 임대료, 관리비, 사무용품, 세금, 마케팅, 장비, 소프트웨어, 컨설팅, 기타잡비
  - 수입/지출 세부 항목 23개 추가
  - 부가세 적용 여부 관리

- **통합 재무 관리 시스템**
  - 수입/지출 통합 대시보드
  - 대차대조표 및 손익계산서
  - 일/월/년 단위 재무 리포트
  - 자동 부가세 계산 시스템
  - 반복 지출 관리 시스템

- **ERP 시스템 확장**
  - 구매 요청 승인 시 자동 지출 거래 생성
  - 급여 계산 시 자동 지출 거래 생성
  - 결제 승인 시 자동 수입 거래 생성
  - 적립금 자동 생성 시스템

### 🔧 개선사항
- **공통 코드 기반 관리**
  - 하드코딩된 문자열 제거
  - 데이터 일관성 및 확장성 향상
  - 중앙 집중식 코드 관리

- **프론트엔드 개선**
  - 공통 코드 API 기반 드롭다운 구성
  - 빠른 지출 등록 기능
  - 실시간 재무 데이터 표시
  - 연한 파스텔톤 디자인 적용

### 📝 기술적 변경사항
- **새로운 클래스**:
  - `FinancialCommonCodeInitializer`: 재무 거래 공통 코드 초기화
  - `FinancialTransaction`: 재무 거래 엔티티
  - `FinancialTransactionService`: 재무 거래 관리 서비스
  - `TaxCalculationUtil`: 부가세 계산 유틸리티
  - `RecurringExpenseService`: 반복 지출 관리 서비스
  - `ReserveFundService`: 적립금 관리 서비스
  - `FinancialTransactionForm.js`: 재무 거래 등록 폼
  - `QuickExpenseForm.js`: 빠른 지출 등록 컴포넌트
  - `IntegratedFinanceDashboard.js`: 통합 재무 대시보드

- **수정된 클래스**:
  - `ErpServiceImpl`: 공통 코드 기반 카테고리 관리
  - `ErpController`: 재무 관련 API 엔드포인트 추가
  - `PaymentServiceImpl`: 자동 수입 거래 생성
  - `SalaryCalculationServiceImpl`: 자동 지출 거래 생성
  - `CommonCodeService`: Map 형태 조회 메서드 추가

## [2025-01-11] - 공통코드 시스템 통합 및 스케줄 관리 개선

### 🆕 새로운 기능
- **공통코드 시스템 통합**
  - `code_groups`와 `code_values` 테이블을 `common_codes` 테이블로 통합
  - 기존 38개 코드 그룹 데이터를 새로운 시스템으로 마이그레이션
  - 통합된 공통코드 관리 시스템 구현

- **스케줄 관리 개선**
  - 지난 시간 슬롯 비활성화 및 시각적 구분 추가
  - 상담 시간 변경 시 동적으로 시간 슬롯 업데이트 기능
  - 스케줄 세부사항에서 선택한 시간을 시작-종료 시간으로 명확하게 표시
  - 100분 상담 시간 선택 시 올바른 시간 표시 기능

### 🔧 개선사항
- **API 엔드포인트 통합**
  - 모든 프론트엔드 컴포넌트에서 `/api/admin/common-codes/values` 사용
  - 기존 `/api/admin/codes/values` 엔드포인트 호환성 유지
  - 데이터 구조 통일 (`codeValue`, `codeLabel`, `codeDescription`)

- **세션 관리 개선**
  - 로그인 전 401 오류를 조용히 처리하도록 수정
  - 세션 체크 중 불필요한 콘솔 오류 제거
  - 사용자 경험 개선

- **스케줄 생성 검증**
  - `endTime` NaN 오류 해결
  - 상담 시간 유효성 검증 강화
  - 시간 슬롯 충돌 방지 로직 개선

### 🗑️ 제거된 기능
- **기존 코드 관리 시스템**
  - `code_groups` 및 `code_values` 테이블 삭제
  - `CodeInitializationServiceImpl` 비활성화
  - 중복된 코드 관리 로직 제거

### 📝 기술적 변경사항
- **새로운 클래스**:
  - `CommonCodeController`: 통합된 공통코드 관리 API
  - `CodeMigrationService`: 기존 데이터 마이그레이션 서비스
- **수정된 클래스**:
  - `CommonCodeServiceImpl`: 통합된 공통코드 서비스 구현
  - `ScheduleModal.js`: 스케줄 생성 UI 개선
  - `TimeSlotGrid.js`: 동적 시간 슬롯 관리
  - 47개 프론트엔드 컴포넌트: API 엔드포인트 및 데이터 구조 업데이트

## [2025-01-10] - 이메일 시스템 구현 및 브랜드명 변경

### 🆕 새로운 기능
- **실제 이메일 발송 시스템**
  - Gmail SMTP를 통한 실제 이메일 발송 기능 구현
  - JavaMailSender를 활용한 MIME 메시지 생성 및 발송
  - 이메일 템플릿 시스템 (환영, 승인, 알림 등)
  - 이메일 발송 상태 추적 및 재시도 기능

- **이메일 테스트 시스템**
  - EmailTestController를 통한 이메일 발송 테스트 API
  - MockEmailServiceImpl을 통한 테스트 모드 지원
  - 이메일 발송 제한 및 통계 기능

- **브랜드명 통일**
  - "마음정원"을 "mindgarden"으로 전면 변경
  - 이메일 제목, 발신자명, 템플릿 내용 일관성 확보
  - 모든 서비스에서 브랜드명 통일

### 🔧 개선사항
- **이메일 설정 관리**
  - application-local.yml에 Gmail SMTP 설정 추가
  - 환경별 이메일 설정 분리 (로컬/운영)
  - 이메일 발송 모드 전환 기능 (실제/Mock)

- **보안 설정**
  - 이메일 테스트 API 접근 권한 설정
  - Gmail App Password를 통한 안전한 인증

### 📝 기술적 변경사항
- **의존성 추가**: spring-boot-starter-mail
- **새로운 클래스**:
  - EmailConfig: JavaMailSender 설정
  - EmailTestController: 이메일 테스트 API
  - MockEmailServiceImpl: 테스트용 이메일 서비스
- **수정된 클래스**:
  - EmailServiceImpl: 실제 SMTP 발송 로직 구현
  - EmailConstants: 브랜드명 변경
  - 모든 서비스 클래스: 이메일 변수 업데이트

## [2025-01-09] - 중복 로그인 방지 시스템 구현

### 🆕 새로운 기능
- **중복 로그인 방지 시스템**
  - 사용자 세션 추적 및 관리 시스템 구현
  - 중복 로그인 감지 시 기존 세션 자동 종료
  - 실시간 중복 로그인 체크 및 알림 기능
  - 세션 만료 자동 정리 시스템

- **사용자 세션 관리**
  - UserSession 엔티티로 세션 정보 저장
  - 클라이언트 IP, User Agent, 로그인 타입 추적
  - 세션 생성/종료/연장 관리
  - 세션 통계 및 모니터링 기능

- **프론트엔드 중복 로그인 감지**
  - DuplicateLoginAlert 컴포넌트 구현
  - 자동 로그아웃 카운트다운 기능
  - 중복 로그인 감지 시 사용자 알림
  - 주기적 세션 상태 확인 (30초 간격)

### 🔧 개선사항
- **보안 강화**
  - 세션 기반 인증 시스템 강화
  - 의심스러운 활동 감지 기능
  - 세션 만료 자동 정리 (스케줄러)
  - 강제 로그아웃 기능 (관리자용)

- **사용자 경험 개선**
  - 중복 로그인 시 명확한 알림 제공
  - 자동 로그아웃 전 사용자 확인 시간 제공
  - 세션 상태 실시간 모니터링

### 🛠️ 기술적 개선
- **백엔드 아키텍처**
  - UserSessionService 인터페이스 및 구현체
  - SessionManagementConstants 상수 관리
  - SessionCleanupScheduler 자동 정리
  - AuthService 중복 로그인 체크 로직

- **데이터베이스 설계**
  - user_sessions 테이블 자동 생성 (Hibernate DDL)
  - 세션 관련 인덱스 최적화
  - 세션 만료 시간 관리

- **API 엔드포인트**
  - `/api/auth/check-duplicate-login` - 중복 로그인 체크
  - `/api/auth/force-logout` - 강제 로그아웃
  - 세션 정보 조회 및 관리

### 🐛 버그 수정
- 최초 로그인 시 중복 로그인 감지 오류 해결
- 현재 세션을 제외한 정확한 중복 감지 로직 구현
- 프론트엔드 중복 로그인 체크 타이밍 최적화

---

## [2025-01-09] - 휴가 관리 시스템 대폭 개선

### 🆕 새로운 기능
- **세밀한 반반차 휴가 유형 추가**
  - 오전 반반차 1: 09:00-11:00 (2시간)
  - 오전 반반차 2: 11:00-13:00 (2시간)
  - 오후 반반차 1: 14:00-16:00 (2시간)
  - 오후 반반차 2: 16:00-18:00 (2시간)

- **관리자 휴가 등록 기능**
  - 스케줄 페이지에서 "휴가 등록" 버튼 추가
  - 상담사별 휴가 직접 등록 가능
  - 휴가 유형별 자동 시간 설정
  - 휴가 사유 입력 기능

- **스마트 스케줄 제한 시스템**
  - 휴가 중인 시간대 자동 제한
  - 반반차 휴가 시 정확한 2시간만 제한
  - 점심시간(13:00-14:00) 항상 사용 가능

### 🔧 개선사항
- **휴가 정보 표시 개선**
  - 캘린더에서 휴가 유형별 정확한 시간 범위 표시
  - 이모지를 활용한 직관적 표시
  - 휴가 상세 모달에서 상세 정보 표시

- **API 응답 구조 개선**
  - 휴가 정보 API 응답 구조 통일
  - 상담사별 휴가 정보 필터링 개선

- **데이터베이스 스키마 업데이트**
  - `vacations` 테이블 ENUM 확장
  - 새로운 휴가 유형 코드 값 추가
  - 기존 데이터 마이그레이션 스크립트 제공

### 🐛 버그 수정
- 휴가 정보가 스케줄 등록 시 제대로 반영되지 않던 문제 해결
- API 응답 구조 불일치로 인한 휴가 정보 로드 실패 수정
- 반반차 휴가 시 잘못된 시간대 제한 문제 해결
- 휴가 상세 모달에서 휴가 유형 표시 오류 수정

### 🔄 백엔드 변경사항
- `VacationType` enum에 새로운 반반차 유형 추가
- `ConsultantAvailabilityServiceImpl` 휴가 시간 확인 로직 개선
- `ScheduleServiceImpl` 휴가 데이터 매핑 개선
- `ScheduleDto`에 `vacationType` 필드 추가

### 🎨 프론트엔드 변경사항
- `VacationManagementModal.js`: 새로운 반반차 유형 지원
- `TimeSlotGrid.js`: 휴가 시간 확인 로직 개선
- `ScheduleDetailModal.js`: 휴가 유형별 표시 개선
- API 응답 구조에 맞춘 데이터 처리 로직 수정

### 📊 데이터베이스 변경사항
- `vacations` 테이블 `vacation_type` ENUM 확장
- `code_values` 테이블에 새로운 휴가 유형 코드 추가
- 기존 `MORNING_HALF`, `AFTERNOON_HALF` 데이터 마이그레이션

### 📚 문서 업데이트
- 휴가 시스템 업데이트 상세 문서 추가 (`docs/VACATION_SYSTEM_UPDATE.md`)
- README.md에 휴가 관리 시스템 기능 추가
- API 문서 업데이트

### 🧪 테스트
- 새로운 반반차 휴가 유형 등록 테스트
- 스케줄 등록 시 휴가 시간 제한 테스트
- 휴가 정보 표시 정확성 테스트
- API 엔드포인트 통합 테스트

---

## [이전 버전들]

### [2025-01-08] - 초기 개발
- 기본 상담 관리 시스템 구축
- OAuth2 소셜 로그인 구현
- 사용자 역할 기반 접근 제어
- 기본 스케줄 관리 기능
- 상담사-내담자 매핑 시스템
