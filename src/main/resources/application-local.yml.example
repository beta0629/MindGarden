# 로컬 개발 환경 설정 예시
# Local Development Environment Configuration Example
#
# 사용 방법:
# 1. 이 파일을 복사하여 application-local.yml 파일을 만듭니다
# 2. 환경 변수는 .env.local 파일 또는 시스템 환경 변수로 설정합니다
# 3. application-local.yml 파일은 Git에 커밋되지 않습니다 (보안)
#
# macOS/Linux: cp src/main/resources/application-local.yml.example src/main/resources/application-local.yml
# Windows: copy src\main\resources\application-local.yml.example src\main\resources\application-local.yml

isDev: true  # 개발 모드 활성화

spring:
  # 데이터베이스 설정 (개발 서버 DB 사용)
  datasource:
    url: jdbc:mysql://${DB_HOST:localhost}:${DB_PORT:3306}/${DB_NAME:mind_garden}?useSSL=false&serverTimezone=Asia/Seoul&characterEncoding=UTF-8&useUnicode=true&characterSetResults=UTF-8&allowPublicKeyRetrieval=true&connectionCollation=utf8mb4_unicode_ci
    username: ${DB_USERNAME:mindgarden_dev}
    password: ${DB_PASSWORD:}  # 필수: 환경 변수로 설정 (예: export DB_PASSWORD="MindGardenDev2025!@#")
    driver-class-name: com.mysql.cj.jdbc.Driver
    # 문자셋 설정 추가
    connection-init-sql: "SET NAMES utf8mb4 COLLATE utf8mb4_unicode_ci"
  
  # 이메일 설정 (Gmail SMTP)
  mail:
    host: smtp.gmail.com
    port: 587
    username: mindgarden1013@gmail.com
    password: ombe ansd pbcx wgrz
    properties:
      mail:
        smtp:
          auth: true
          starttls:
            enable: true
          ssl:
            trust: smtp.gmail.com
          connectiontimeout: 10000
          timeout: 10000
          writetimeout: 10000
        debug: true  # 로컬에서 디버그 활성화
  
  # OAuth2 설정
  security:
    oauth2:
      client:
        registration:
          kakao:
            client-id: cbb457cfb5f9351fd495be4af2b11a34
            client-secret: LH53SXuqZk7iEVeDkKfQuKxW0sdxYmEG
            scope: profile_nickname,account_email
            redirect-uri: "${server.base-url}/api/auth/kakao/callback"
            client-authentication-method: post
            authorization-grant-type: authorization_code
            client-name: Kakao
          naver:
            client-id: vTKNlxYKIfo1uCCXaDfk
            client-secret: V_b3omW5pu
            scope: name,email
            redirect-uri: "${server.base-url}/api/auth/naver/callback"
            client-authentication-method: post
            authorization-grant-type: authorization_code
            client-name: Naver
        provider:
          kakao:
            authorization-uri: https://kauth.kakao.com/oauth/authorize
            token-uri: https://kauth.kakao.com/oauth/token
            user-info-uri: https://kapi.kakao.com/v2/user/me
            user-name-attribute: id
          naver:
            authorization-uri: https://nid.naver.com/oauth2.0/authorize
            token-uri: https://nid.naver.com/oauth2.0/token
            user-info-uri: https://openapi.naver.com/v1/nid/me
            user-name-attribute: response

# JWT 설정
jwt:
  secret: ${JWT_SECRET:mindgarden-jwt-secret-key-2025-local-development-only}
  expiration: 3600000   # 1시간 (밀리초)
  refresh-expiration: 604800000  # 7일 (밀리초)

# 개인정보 암호화 설정
encryption:
  personal-data:
    key: ${PERSONAL_DATA_ENCRYPTION_KEY:mindgarden_encryption_key_2025_local_dev}
    iv: ${PERSONAL_DATA_ENCRYPTION_IV:mindgarden_iv_2025_local}
    algorithm: AES-256
    transformation: AES/CBC/PKCS5Padding

# 프론트엔드 설정
frontend:
  base-url: ${FRONTEND_BASE_URL:http://localhost:3000}

# 이메일 테스트 설정
email:
  test:
    enabled: true
    mock-mode: false  # 실제 Gmail SMTP 사용
    test-recipient: ${TEST_EMAIL:test@example.com}

# SMS 인증 설정 (로컬 개발용)
sms:
  auth:
    enabled: ${SMS_AUTH_ENABLED:false}  # 로컬에서는 비활성화 (비용 절약)
    test-mode: true  # 테스트 모드 활성화
    mock-verification-code: ${SMS_MOCK_CODE:123456}  # 테스트용 고정 인증번호

# 카카오 알림톡 설정
kakao:
  alimtalk:
    enabled: true  # 알림톡 활성화
    simulation-mode: true  # 시뮬레이션 모드 (개발/테스트용)
    api-key: ${KAKAO_ALIMTALK_API_KEY:test-api-key}  # 실제 API 키로 교체 필요
    sender-key: ${KAKAO_ALIMTALK_SENDER_KEY:test-sender-key}  # 실제 발신자 키로 교체 필요
    api-url: https://alimtalk-api.bizmsg.kr  # 카카오 알림톡 API URL
    fallback-to-sms: true  # 알림톡 실패 시 SMS 대체 발송
    max-retry-count: 3  # 최대 재시도 횟수
    timeout-seconds: 30  # API 타임아웃 시간

# 세션 보안 설정
server:
  # 서버 기본 URL (로컬 개발용)
  # 환경 변수 SERVER_BASE_URL로 설정 가능 (미설정 시 기본값: localhost:8080)
  # 에뮬레이터 테스트: export SERVER_BASE_URL=http://10.0.2.2:8080
  # 실제 기기 테스트: export SERVER_BASE_URL=http://192.168.0.71:8080
  base-url: ${SERVER_BASE_URL:http://localhost:8080}
  # 에뮬레이터 접근을 위해 모든 인터페이스에서 리스닝 (0.0.0.0 = 모든 IP)
  address: 0.0.0.0
  port: ${SERVER_PORT:8080}
  servlet:
    session:
      timeout: 30m  # 세션 타임아웃 (30분)
      cookie:
        http-only: true  # XSS 공격 방지
        secure: false    # 로컬 환경에서는 false (HTTPS 사용 시 true)
        same-site: lax   # CSRF 공격 방지
        max-age: 1800    # 쿠키 만료 시간 (30분)

# 보안 설정
security:
  password:
    strength: 12  # BCrypt 강도 (10-12 권장)
    policy:
      min-length: 8
      max-length: 128
      require-uppercase: true
      require-lowercase: true
      require-digit: true
      require-special-char: true
      prevent-common-patterns: true
      prevent-consecutive-chars: true
      prevent-repeated-chars: true

