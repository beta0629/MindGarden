# 구독 환불 및 청약 철회 방침

**작성일:** 2025-01-XX  
**버전:** 1.0.0  
**목적:** 구독 환불 및 청약 철회 정책 명확화

---

## 1. 개요

MindGarden SaaS 서비스의 구독 환불 및 청약 철회 정책을 정의합니다.  
이 정책은 소비자 보호를 위한 법적 요구사항과 서비스 운영 정책을 반영합니다.

---

## 2. 청약 철회 기간

### 2.1 기본 정책

**청약 철회 기간: 결제일로부터 15일**

- **법적 근거:** 전자상거래법 제17조 (청약철회 등)
- **적용 대상:** 모든 구독 요금제
- **시작일:** 구독 생성일 (첫 결제일)
- **종료일:** 구독 생성일로부터 15일 후

### 2.2 예외 사항

**청약 철회 불가:**
- 청약 철회 기간(15일) 경과 후
- 구독 상태가 `ACTIVE`가 아닌 경우
- 이미 환불 처리된 구독
- 서비스 이용 시작 후 상당 부분 이용한 경우 (추후 정책 수립 예정)

---

## 3. 환불 정책

### 3.1 전체 환불

**조건:**
- 청약 철회 기간 내 (15일 이내)
- 구독 상태가 `ACTIVE`
- 환불 금액이 0보다 큼

**환불 금액 계산:**
```
환불 금액 = (월 요금 / 청구 주기 일수) × 남은 일수
```

**예시:**
- 요금제: 월 100,000원
- 결제일: 2025-01-01
- 환불 요청일: 2025-01-10 (10일 경과)
- 남은 기간: 20일
- 청구 주기: 30일

```
일일 요금 = 100,000원 / 30일 = 3,333원
환불 금액 = 3,333원 × 20일 = 66,660원
```

**처리:**
- 구독 상태를 `CANCELLED`로 변경
- `effectiveTo`를 오늘로 설정
- `autoRenewal`을 `false`로 설정
- PG 환불 API 호출 (추후 구현)

### 3.2 부분 환불

**조건:**
- 청약 철회 기간 내 (15일 이내)
- 구독 상태가 `ACTIVE`
- 환불 요청 일수가 남은 일수 이하

**환불 금액 계산:**
```
환불 금액 = (월 요금 / 청구 주기 일수) × 환불 요청 일수
```

**처리:**
- 구독 상태 유지 (필요시 `SUSPENDED`로 변경 가능)
- 환불 금액만 처리
- PG 환불 API 호출 (추후 구현)

### 3.3 환불 불가 사유

**청약 철회 기간 경과:**
- 결제일로부터 15일 초과
- 예외: 특별 정책에 의한 연장 (추후 정책 수립)

**구독 상태:**
- `ACTIVE` 상태가 아닌 경우
- 이미 `CANCELLED` 또는 `TERMINATED` 상태

**기타:**
- 환불 금액이 0 이하
- 환불 요청 일수가 남은 일수 초과

---

## 4. 요금제 변경 시 환불

### 4.1 다운그레이드 환불

**조건:**
- 요금제 다운그레이드 시
- 즉시 적용 (`applyImmediately = true`)

**환불 금액 계산:**
```
일일 차액 = (새 요금 - 현재 요금) / 청구 주기 일수
환불 금액 = 일일 차액 × 남은 일수
```

**예시:**
- 현재 요금제: 월 200,000원
- 새 요금제: 월 100,000원
- 남은 기간: 15일
- 청구 주기: 30일

```
일일 차액 = (100,000 - 200,000) / 30일 = -3,333원
환불 금액 = 3,333원 × 15일 = 50,000원
```

### 4.2 업그레이드 추가 결제

**조건:**
- 요금제 업그레이드 시
- 즉시 적용 (`applyImmediately = true`)

**추가 결제 금액 계산:**
```
일일 차액 = (새 요금 - 현재 요금) / 청구 주기 일수
추가 결제 = 일일 차액 × 남은 일수
```

**예시:**
- 현재 요금제: 월 100,000원
- 새 요금제: 월 200,000원
- 남은 기간: 15일
- 청구 주기: 30일

```
일일 차액 = (200,000 - 100,000) / 30일 = 3,333원
추가 결제 = 3,333원 × 15일 = 50,000원
```

---

## 5. 설정 및 관리

### 5.1 현재 설정

**코드 위치:**
- `SubscriptionRefundServiceImpl.java`
- `COOLING_OFF_PERIOD_DAYS = 15` (하드코딩)

**향후 개선:**
- `application.yml`로 설정 이동
- 환경별 다른 정책 적용 가능
- 요금제별 다른 청약 철회 기간 설정 가능

### 5.2 설정 파일화 (추후 구현)

**application.yml 예시:**
```yaml
subscription:
  refund:
    cooling-off-period-days: 15  # 청약 철회 기간 (일)
    enable-partial-refund: true   # 부분 환불 허용 여부
    refund-calculation-method: PRORATED  # PRORATED, FULL
    plans:
      STARTER:
        cooling-off-period-days: 15
      STANDARD:
        cooling-off-period-days: 15
      PREMIUM:
        cooling-off-period-days: 30  # 프리미엄 플랜은 30일
```

---

## 6. 처리 프로세스

### 6.1 환불 요청 프로세스

```
1. 환불 요청 접수
   ↓
2. 청약 철회 기간 확인
   - 결제일로부터 15일 이내?
   ↓
3. 구독 상태 확인
   - ACTIVE 상태인가?
   ↓
4. 환불 금액 계산
   - 일할 계산
   ↓
5. 환불 가능 여부 확인
   - 환불 금액 > 0?
   ↓
6. PG 환불 API 호출
   - 실제 환불 처리
   ↓
7. 구독 상태 업데이트
   - 전체 환불: CANCELLED
   - 부분 환불: 상태 유지
   ↓
8. 환불 완료 알림 발송
```

### 6.2 환불 거부 프로세스

```
1. 환불 요청 접수
   ↓
2. 청약 철회 기간 확인
   - 15일 초과 → 거부
   ↓
3. 구독 상태 확인
   - ACTIVE 아님 → 거부
   ↓
4. 환불 금액 계산
   - 0 이하 → 거부
   ↓
5. 거부 사유 안내
   - 이메일/앱 푸시
```

---

## 7. 법적 고려사항

### 7.1 전자상거래법

**제17조 (청약철회 등)**
- 청약철회 기간: 7일 (법정 최소)
- 현재 정책: 15일 (법정 최소보다 여유 있음)

**제18조 (청약철회의 효과)**
- 대금 환불 의무
- 환불 지연 시 지연 손해금 지급

### 7.2 소비자기본법

**제18조 (소비자 권익 보호)**
- 공정한 거래 조건
- 명확한 약관 제공

### 7.3 향후 고려사항

- **디지털 콘텐츠 특성:**
  - 서비스 이용 시작 후 청약 철회 제한 가능
  - 상당 부분 이용 시 환불 제한 (추후 정책 수립)

- **특별 정책:**
  - 기업 고객: 별도 계약 조건
  - 연간 구독: 연장된 청약 철회 기간 (추후 정책 수립)

---

## 8. 예외 처리

### 8.1 특별 사례

**기업 고객:**
- 별도 계약 조건 적용 가능
- 계약서에 명시된 환불 정책 우선

**프로모션 구독:**
- 프로모션별 다른 정책 적용 가능
- 프로모션 약관에 명시

**연간 구독:**
- 연간 구독은 연장된 청약 철회 기간 고려 (추후 정책 수립)
- 예: 30일 또는 60일

### 8.2 관리자 개입

**특별 환불:**
- 관리자 승인 하에 청약 철회 기간 초과 환불 가능
- 사유 기록 및 감사 로그 저장

**부분 환불:**
- 특별 사유로 부분 환불 가능
- 예: 서비스 장애, 약관 변경 등

---

## 9. 통계 및 모니터링

### 9.1 환불 통계

**추적 항목:**
- 환불 요청 건수
- 환불 승인/거부 건수
- 환불 금액 합계
- 평균 환불 금액
- 청약 철회 기간별 환불 분포

### 9.2 모니터링

**알림 대상:**
- 일일 환불 금액이 임계값 초과 시
- 환불률이 임계값 초과 시
- 특이 환불 패턴 감지 시

---

## 10. 향후 개선 계획

### 10.1 단기 (1-3개월)

1. **설정 파일화**
   - `application.yml`로 청약 철회 기간 설정 이동
   - 요금제별 다른 정책 적용

2. **PG 연동 강화**
   - 실제 환불 API 호출
   - 환불 상태 추적

3. **알림 시스템**
   - 환불 완료 알림
   - 환불 거부 알림

### 10.2 중기 (3-6개월)

1. **자동화 강화**
   - 환불 요청 자동 처리
   - 환불 승인 워크플로우

2. **정책 세분화**
   - 요금제별 다른 청약 철회 기간
   - 업종별 다른 정책

3. **통계 대시보드**
   - 환불 통계 시각화
   - 환불 패턴 분석

### 10.3 장기 (6개월 이상)

1. **AI 기반 예측**
   - 환불 가능성 예측
   - 환불 방지 전략

2. **국제화**
   - 국가별 다른 정책
   - 현지 법규 준수

3. **고객 성공 연동**
   - 환불 요청 시 고객 성공팀 알림
   - 환불 방지 캠페인

---

## 11. 관련 문서

- `docs/mgsb/SUBSCRIPTION_MANAGEMENT_GUIDE.md` - 구독 관리 전체 가이드
- `src/main/java/com/coresolution/core/service/billing/impl/SubscriptionRefundServiceImpl.java` - 환불 처리 구현
- `src/main/java/com/coresolution/core/service/billing/SubscriptionRefundService.java` - 환불 서비스 인터페이스

---

## 12. 문의

**정책 관련 문의:**
- 이메일: ops@mindgarden.com
- 담당: 운영팀

**기술 관련 문의:**
- 이메일: dev@mindgarden.com
- 담당: 개발팀

---

**최종 수정일:** 2025-01-XX  
**다음 검토 예정일:** 2025-04-XX (분기별 검토)

