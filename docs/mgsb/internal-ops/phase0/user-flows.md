# Internal Operator Portal – User Flows & Permission Matrix (Draft)

작성일: 2025-11-13

## 1. 주요 역할 정의
| 역할 | 설명 | 주요 책임 | 권한 레벨 |
| --- | --- | --- | --- |
| HQ_MASTER | MindGarden HQ 총괄 | 정책/요금제 승인, Feature Flag 관리, 감사 보고 승인 | Level 5 |
| HQ_ADMIN | 운영 관리자 | 온보딩 승인, 요금제/애드온 처리, 대시보드 모니터링 | Level 4 |
| SRE | 플랫폼 엔지니어 | 배포 제어, 배치 모니터링, Incident 대응 | Level 4 |
| SECURITY | 보안 담당 | 권한 감사, 보안 이벤트 분석, 정책 변경 | Level 3 |
| CS | 고객 지원 | 테넌트 티켓 처리, 공지/알림 발송, 진단 리포트 | Level 2 |
| VIEW_ONLY | 읽기 전용 | KPI/보고서 조회 | Level 1 |

## 2. 사용자 여정 (예시)
### 2.1 테넌트 온보딩 승인 (HQ_ADMIN)
1. 알림 수신 → 대시보드에서 신규 요청 확인 (Step 1)
2. 온보딩 체크리스트 검토 → 결제/권한/데이터 단계 확인 (Step 2)
3. 승인 또는 보류 선택 → 사유 입력 → 자동 알림 발송 (Step 3)
4. 승인 후 자동 플래그/AI 설정 적용 → 감사 로그 기록 (Step 4)

### 2.2 배포 제어 (SRE)
1. 대시보드에서 배포 파이프라인 상태 확인
2. 신규 릴리스 승인 요청 → Blue/Green 옵션 선택 → 트래픽 전환 스케줄 지정
3. 배포 완료 후 검증 체크리스트 실행 → 실패 시 롤백 버튼으로 즉시 복구

### 2.3 고객 티켓 처리 (CS)
1. 티켓 목록 확인 → SLA 우선순위 정렬
2. FAQ/Runbook 참고 후 응답 작성 → 필요 시 HQ_ADMIN에게 Escalation
3. 해결 후 만족도 기록 → 개선 요청은 백로그에 등록

## 3. 권한 매트릭스 (요약)
| 기능 | HQ_MASTER | HQ_ADMIN | SRE | SECURITY | CS | VIEW_ONLY |
| --- | --- | --- | --- | --- | --- | --- |
| 대시보드 전체 보기 | O | O | O | O | △ (제한) | △ |
| 온보딩 승인 | O | O | X | X | X | X |
| 요금제/애드온 관리 | O | O | X | X | △ (보기) | X |
| 배포 제어 | O | △ (검토) | O | X | X | X |
| 권한 템플릿 변경 | O | △ (제안) | X | O | X | X |
| 감사 로그 열람 | O | △ (요약) | △ (관련) | O | X | X |
| 공지/알림 발송 | O | O | △ (사고 공지) | △ (보안 경보) | O | X |
| 티켓/FAQ 관리 | O | O | △ (Incident) | △ (보안) | O | △ (보기) |

`O`: 허용, `△`: 제한적 허용/읽기 전용, `X`: 금지

## 4. 데이터 접근 범위
- Level 5: 모든 테넌트 데이터 접근, 설정·정책 변경 가능
- Level 4: 담당 테넌트/기능 범위 내 쓰기 가능, 특정 글로벌 설정 접근 제한
- Level 3: 감사/보안 관련 읽기, 위험도 높은 설정은 HQ_MASTER 승인 필요
- Level 2: 테넌트별 지원 기능 쓰기, 민감 데이터는 마스킹
- Level 1: KPI/리포트 읽기, 행위 로그 없음

## 5. 향후 작업
- 상세 UI 플로우 다이어그램(Figma) 링크 추가
- ABAC 정책 JSON 정의 (`role_level`, `tenant_id`, `branch_id`, `department`)
- 각 여정별 Alert/Notification 정책 문서화
