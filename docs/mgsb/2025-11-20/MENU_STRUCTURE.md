# 메뉴 구조도

**작성일**: 2025-11-20  
**버전**: 1.0.0  
**상태**: 완료

---

## 📋 개요

CoreSolution 플랫폼의 메뉴 구조를 정리한 문서입니다. 메뉴는 CommonCode 기반으로 동적으로 관리되며, 역할별로 다른 메뉴 구조를 가질 수 있습니다.

---

## 🏗️ 메뉴 시스템 구조

### 메뉴 관리 방식

**CommonCode 기반 동적 메뉴:**
- 메뉴 정보는 `common_codes` 테이블에 저장
- 코드 그룹: `MENU_GROUP`, `MENU_ITEM`
- 역할별 메뉴 접근 권한은 `PermissionMatrix` 또는 `DynamicPermissionService`로 관리

**메뉴 그룹 구조:**
```
COMMON_MENU (공통 메뉴)
  ├─ 모든 역할에서 접근 가능
  └─ 프로필, 설정 등

{ROLE}_MENU (역할별 메뉴)
  ├─ 특정 역할에서만 접근 가능
  └─ 역할별 기능 메뉴
```

---

## 📊 전체 메뉴 구조 (범용 패턴)

### 공통 메뉴 (COMMON_MENU)

**모든 역할에서 접근 가능:**

```
공통 메뉴
├─ 대시보드
│   └─ 홈
├─ 프로필
│   ├─ 내 정보
│   ├─ 비밀번호 변경
│   └─ 알림 설정
└─ 설정
    ├─ 언어 설정
    └─ 테마 설정
```

---

### 레벨 1: 기본 사용자 메뉴 (범용 패턴)

**주요 메뉴:**
```
기본 사용자 메뉴
├─ 대시보드
├─ 서비스/강좌 목록
├─ 예약/수강 내역
├─ 결제 내역
└─ 프로필
```

**예시 (학원 - 학생):**
```
학생 메뉴
├─ 대시보드
├─ 강좌 목록
├─ 수강 내역
├─ 출석 확인
├─ 성적 조회
└─ 프로필
```

**예시 (상담소 - 내담자):**
```
내담자 메뉴
├─ 대시보드
├─ 상담 예약
├─ 상담 내역
├─ 결제 내역
└─ 프로필
```

---

### 레벨 2: 서비스 제공자 메뉴 (범용 패턴)

**주요 메뉴:**
```
서비스 제공자 메뉴
├─ 대시보드
├─ 일정 관리
├─ 할당된 사용자 관리
├─ 기록 작성
├─ 통계 (자신의 서비스)
└─ 프로필
```

**예시 (학원 - 선생님):**
```
선생님 메뉴
├─ 대시보드
├─ 반 관리
├─ 출석 체크
├─ 성적 입력
├─ 학생 관리
└─ 프로필
```

**예시 (상담소 - 상담사):**
```
상담사 메뉴
├─ 대시보드
├─ 일정 관리
├─ 할당된 내담자
├─ 상담 기록 작성
├─ 상담 통계
└─ 프로필
```

---

### 레벨 3: 관리자 메뉴 (범용 패턴)

**주요 메뉴:**
```
관리자 메뉴
├─ 대시보드
├─ 사용자 관리
│   ├─ 사용자 목록
│   ├─ 사용자 추가/수정
│   └─ 역할 할당
├─ 통계/리포트
│   ├─ 전체 통계
│   ├─ 리포트 다운로드
│   └─ 분석
├─ 일정 관리
│   ├─ 전체 일정 조회
│   └─ 일정 관리
├─ 결제 관리
│   ├─ 결제 내역
│   └─ 정산
└─ 설정 관리
    ├─ 공통 코드 관리
    │   ├─ CoreSolution 공통 코드 (읽기 전용)
    │   └─ 입점사 공통 코드 (읽기/쓰기)
    ├─ 시스템 설정
    └─ 알림 설정
```

---

### 레벨 4: 최고 관리자 메뉴 (범용 패턴)

**주요 메뉴:**
```
최고 관리자 메뉴
├─ 레벨 3의 모든 메뉴
├─ 역할 관리
│   ├─ 역할 목록
│   ├─ 역할 생성/수정
│   └─ 권한 설정
├─ ERP 관리 (BRANCH_SUPER_ADMIN, HQ_MASTER 등)
│   ├─ ERP 대시보드
│   ├─ 구매 요청
│   ├─ 관리자 승인
│   ├─ 수퍼 관리자 승인
│   ├─ 아이템 관리
│   ├─ 예산 관리
│   └─ 주문 관리
└─ 시스템 설정
    ├─ 테넌트 설정
    └─ 고급 설정
```

---

### ERP 관리자 메뉴 (BRANCH_SUPER_ADMIN, HQ_MASTER 등)

**주요 메뉴:**
```
ERP 관리 메뉴
├─ ERP 대시보드
├─ 구매 요청
│   ├─ 구매 요청 목록
│   └─ 구매 요청 생성
├─ 승인 관리
│   ├─ 관리자 승인
│   └─ 수퍼 관리자 승인
├─ 아이템 관리
│   ├─ 아이템 목록
│   ├─ 아이템 추가/수정
│   └─ 재고 관리
├─ 예산 관리
│   ├─ 예산 목록
│   ├─ 예산 추가/수정
│   └─ 예산 통계
└─ 주문 관리
    ├─ 주문 목록
    └─ 주문 상세
```

**메뉴 접근 권한:**
- BRANCH_SUPER_ADMIN: ERP 메뉴 접근 가능
- HQ_MASTER: 모든 ERP 메뉴 접근 가능
- ADMIN: ERP 메뉴 접근 불가

---

## 🎯 MindGarden 메뉴 구조 (예시)

### 내담자 (CLIENT) 메뉴

```
내담자 메뉴
├─ 대시보드
├─ 상담 예약
│   ├─ 상담사 선택
│   └─ 일정 선택
├─ 상담 내역
│   ├─ 예정된 상담
│   ├─ 완료된 상담
│   └─ 취소된 상담
├─ 상담 메시지
├─ 결제 내역
└─ 프로필
```

---

### 상담사 (CONSULTANT) 메뉴

```
상담사 메뉴
├─ 대시보드
├─ 일정 관리
│   ├─ 캘린더 보기
│   ├─ 일정 추가
│   └─ 일정 수정
├─ 할당된 내담자
│   ├─ 내담자 목록
│   └─ 내담자 상세
├─ 상담 기록
│   ├─ 상담 기록 작성
│   └─ 상담 기록 조회
├─ 상담 통계
└─ 프로필
```

---

### 관리자 (ADMIN) 메뉴

```
관리자 메뉴
├─ 대시보드
├─ 사용자 관리
│   ├─ 상담사 관리
│   ├─ 내담자 관리
│   └─ 사용자 추가/수정
├─ 일정 관리
│   ├─ 전체 일정 조회
│   └─ 일정 관리
├─ 통계
│   ├─ 전체 통계
│   ├─ 상담 통계
│   └─ 리포트
├─ 결제 관리
│   ├─ 결제 내역
│   └─ 정산
├─ 매핑 관리
│   ├─ 상담사-내담자 매핑
│   └─ 회기 관리
└─ 설정
    ├─ 공통코드 관리
    └─ 시스템 설정
```

---

### 본사 관리자 (HQ_MASTER) 메뉴

```
본사 관리자 메뉴
├─ 대시보드
├─ 테넌트 관리
│   ├─ 테넌트 목록
│   ├─ 테넌트 상세
│   └─ 온보딩 관리
├─ 전체 통계
│   ├─ 전체 테넌트 통계
│   └─ 리포트
├─ 역할 관리
│   ├─ 역할 템플릿 관리
│   └─ 권한 관리
└─ 시스템 설정
    ├─ 컴포넌트 관리
    └─ 요금제 관리
```

---

## 🔐 메뉴 권한 매트릭스

### 범용 메뉴 권한 패턴

| 메뉴 그룹 | 레벨 1 | 레벨 2 | 레벨 3 | 레벨 4 |
|----------|--------|--------|--------|--------|
| COMMON_MENU | ✅ | ✅ | ✅ | ✅ |
| {ROLE}_MENU (레벨 1) | ✅ | ❌ | ❌ | ❌ |
| {ROLE}_MENU (레벨 2) | ❌ | ✅ | ❌ | ❌ |
| {ROLE}_MENU (레벨 3) | ❌ | ❌ | ✅ | ✅ |
| {ROLE}_MENU (레벨 4) | ❌ | ❌ | ❌ | ✅ |

**참고**: 실제 권한은 입점사마다 다를 수 있습니다.

---

## 🔄 동적 메뉴 시스템

### 메뉴 조회 프로세스

```
1. 사용자 역할 조회
   ↓
2. 역할별 메뉴 그룹 조회
   ├─ COMMON_MENU
   └─ {ROLE}_MENU
   ↓
3. CommonCode에서 메뉴 정보 조회
   ↓
4. 메뉴 트리 구조 생성
   ↓
5. 동적 경로 적용
   ↓
6. 메뉴 구조 반환
```

### 메뉴 권한 검증

```
메뉴 접근 요청
  ↓
MenuService.hasMenuPermission()
  ↓
DynamicPermissionService.hasMenuGroupAccess()
  ↓
권한 확인
  ├─ 공통 메뉴: 모든 역할 접근 가능
  └─ 역할별 메뉴: 역할 확인
  ↓
접근 허용/거부
```

---

## 📱 반응형 메뉴 구조

### 데스크탑

- **사이드바 네비게이션**
  - 메인 메뉴 항목
  - 서브 메뉴 (드롭다운)
  - 아이콘 + 텍스트

### 태블릿

- **햄버거 메뉴**
  - 메인 메뉴 항목
  - 서브 메뉴 (아코디언)
  - 아이콘 + 텍스트

### 모바일

- **하단 네비게이션**
  - 주요 메뉴만 표시 (최대 5개)
  - 서브 메뉴는 페이지 내에서 접근
  - 아이콘 중심

---

## ⚠️ 중요 사항

1. **동적 메뉴 시스템**
   - 메뉴는 CommonCode 기반으로 동적으로 관리
   - 역할별 메뉴 접근 권한은 데이터베이스에서 관리

2. **MindGarden은 예시**
   - MindGarden의 메뉴 구조는 CONSULTATION 업종의 예시
   - 다른 상담소는 다른 메뉴 구조를 가질 수 있음

3. **테넌트별 커스터마이징**
   - 테넌트 관리자가 메뉴 커스터마이징 가능
   - 역할별 메뉴 활성화/비활성화 가능

---

## 🔗 관련 문서

- [역할별 메뉴 구조도](./MENU_BY_ROLE.md)
- [MindGarden 예시 메뉴 구조](./MENU_EXAMPLES_MINDGARDEN.md)
- [동적 역할 시스템](./DYNAMIC_ROLE_SYSTEM.md)

---

**마지막 업데이트**: 2025-11-20

